"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 15 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤.
–°–æ–∑–¥–∞—ë—Ç –æ—Ç—á—ë—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ —Å –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.
"""

import random
from pathlib import Path
from typing import Dict, List, Tuple
from datetime import datetime, timedelta
import logging

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
REPORTS_DIR = Path(__file__).parent.parent / "data" / "raw" / "reports"
REPORTS_DIR.mkdir(parents=True, exist_ok=True)

# –ê–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
ANONYMOUS_ORGS = [
    "–û–û–û ¬´–≠–ª–µ–∫—Ç—Ä–æ–¢–µ—Å—Ç¬ª",
    "–û–û–û ¬´–≠–Ω–µ—Ä–≥–æ–õ–∞–±¬ª",
    "–û–û–û ¬´–≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å¬ª",
    "–û–û–û ¬´–¢–µ—Ö–Ω–æ–ò—Å–ø—ã—Ç–∞–Ω–∏—è¬ª",
    "–û–û–û ¬´–≠–ª–µ–∫—Ç—Ä–æ–ö–æ–Ω—Ç—Ä–æ–ª—å¬ª"
]

ANONYMOUS_CUSTOMERS = [
    "–û–û–û ¬´–°—Ç—Ä–æ–π–ü—Ä–æ–µ–∫—Ç¬ª",
    "–û–û–û ¬´–ì–æ—Ä–æ–¥–°—Ç—Ä–æ–π¬ª",
    "–û–û–û ¬´–ò–Ω–≤–µ—Å—Ç–°—Ç—Ä–æ–π¬ª",
    "–û–û–û ¬´–†–µ–≥–∏–æ–Ω–°—Ç—Ä–æ–π¬ª",
    "–û–û–û ¬´–ù–æ–≤–æ–°—Ç—Ä–æ–π¬ª"
]

ANONYMOUS_CITIES = [
    "–≥. –ú–æ—Å–∫–≤–∞",
    "–≥. –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "–≥. –ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫",
    "–≥. –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",
    "–≥. –ö–∞–∑–∞–Ω—å",
    "–≥. –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥",
    "–≥. –ß–µ–ª—è–±–∏–Ω—Å–∫",
    "–≥. –°–∞–º–∞—Ä–∞",
    "–≥. –û–º—Å–∫",
    "–≥. –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É"
]

ANONYMOUS_STREETS = [
    "—É–ª. –°—Ç—Ä–æ–∏—Ç–µ–ª–µ–π",
    "—É–ª. –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–∞—è",
    "–ø—Ä. –õ–µ–Ω–∏–Ω–∞",
    "—É–ª. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è",
    "–ø—Ä. –ú–∏—Ä–∞",
    "—É–ª. –ó–∞–≤–æ–¥—Å–∫–∞—è",
    "—É–ª. –°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è",
    "–ø—Ä. –ü–æ–±–µ–¥—ã",
    "—É–ª. –®–∫–æ–ª—å–Ω–∞—è",
    "—É–ª. –°–∞–¥–æ–≤–∞—è"
]

# –û–±—ä–µ–∫—Ç—ã –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤
REPORT_OBJECTS = [
    # –°—Ç–∞–¥–∏–æ–Ω—ã –∏ –º–∞–Ω–µ–∂–∏ (3)
    {"type": "stadium", "name": "–§—É—Ç–±–æ–ª—å–Ω—ã–π –º–∞–Ω–µ–∂", "category": "–°–ø–æ—Ä—Ç"},
    {"type": "stadium", "name": "–°—Ç–∞–¥–∏–æ–Ω ¬´–°–ø–æ—Ä—Ç¬ª, –∑–∞–ø–∞–¥–Ω–∞—è —Ç—Ä–∏–±—É–Ω–∞", "category": "–°–ø–æ—Ä—Ç"},
    {"type": "stadium", "name": "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å ¬´–ê—Ç–ª–µ—Ç¬ª", "category": "–°–ø–æ—Ä—Ç"},
    
    # –¢–æ—Ä–≥–æ–≤—ã–µ —Ü–µ–Ω—Ç—Ä—ã (3)
    {"type": "mall", "name": "–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä ¬´–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π¬ª", "category": "–¢–æ—Ä–≥–æ–≤–ª—è"},
    {"type": "mall", "name": "–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä ¬´–ú–µ–≥–∞¬ª, –ø–æ–¥–∑–µ–º–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞", "category": "–¢–æ—Ä–≥–æ–≤–ª—è"},
    {"type": "mall", "name": "–¢–æ—Ä–≥–æ–≤—ã–π —Ü–µ–Ω—Ç—Ä ¬´–¢–æ—Ä–≥¬ª, —Å–∫–ª–∞–¥—Å–∫–æ–π –∫–æ–º–ø–ª–µ–∫—Å", "category": "–¢–æ—Ä–≥–æ–≤–ª—è"},
    
    # –®–∫–æ–ª—ã –∏ –¥–µ—Ç—Å–∫–∏–µ —Å–∞–¥—ã (3)
    {"type": "school", "name": "–°—Ä–µ–¥–Ω—è—è –æ–±—â–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è —à–∫–æ–ª–∞ ‚Ññ 1", "category": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"},
    {"type": "school", "name": "–î–µ—Ç—Å–∫–∏–π —Å–∞–¥ ¬´–°–æ–ª–Ω—ã—à–∫–æ¬ª", "category": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"},
    {"type": "school", "name": "–°—Ä–µ–¥–Ω—è—è —à–∫–æ–ª–∞ ‚Ññ 5, —Å–ø–æ—Ä—Ç–∏–≤–Ω—ã–π –∑–∞–ª", "category": "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ"},
    
    # –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ü–µ—Ö–∞ (3)
    {"type": "factory", "name": "–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π —Ü–µ—Ö ‚Ññ 1", "category": "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å"},
    {"type": "factory", "name": "–°–∫–ª–∞–¥ –≥–æ—Ç–æ–≤–æ–π –ø—Ä–æ–¥—É–∫—Ü–∏–∏", "category": "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å"},
    {"type": "factory", "name": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–µ –∑–¥–∞–Ω–∏–µ –∑–∞–≤–æ–¥–∞", "category": "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å"},
    
    # –ñ–∏–ª—ã–µ –¥–æ–º–∞ (3)
    {"type": "residential", "name": "–ú–Ω–æ–≥–æ–∫–≤–∞—Ä—Ç–∏—Ä–Ω—ã–π –∂–∏–ª–æ–π –¥–æ–º ‚Ññ 15", "category": "–ñ–∏–ª—å—ë"},
    {"type": "residential", "name": "–ñ–∏–ª–æ–π –¥–æ–º ¬´–ö–æ–º—Ñ–æ—Ä—Ç¬ª, –ø–æ–¥–∑–µ–º–Ω–∞—è –ø–∞—Ä–∫–æ–≤–∫–∞", "category": "–ñ–∏–ª—å—ë"},
    {"type": "residential", "name": "–ñ–∏–ª–æ–π –∫–æ–º–ø–ª–µ–∫—Å ¬´–ù–æ–≤—ã–π –∫–≤–∞—Ä—Ç–∞–ª¬ª", "category": "–ñ–∏–ª—å—ë"},
]

# –¢–∏–ø—ã –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
CABLE_TYPES = [
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x70",
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x6",
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x10",
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x16",
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x25",
    "–ü–ü–ì–Ω–≥(–ê)-HF 5x4",
    "–ü–ü–ì–Ω–≥(–ê)-HF 3x2,5",
    "–ü–ü–ì–Ω–≥(–ê)-HF 3x4",
    "–ü–ü–ì–Ω–≥(–ê)-FRHF 5x35",
    "–ü–ü–ì–Ω–≥(–ê)-FRHF 5x6",
    "–ü–ü–ì–Ω–≥(–ê)-FRHF 5x4",
    "–ü–ü–ì–Ω–≥(–ê)-FRHF 3x2,5",
    "–ö–ü–ü–ì–Ω–≥(–ê)-HF 7x0,75",
    "–ö–ü–ü–ì–≠–Ω–≥(–ê)-HF 4x1,5",
    "–ü–†–ö–° 1x4"
]

BREAKER_TYPES = [
    "–í–ê-201 D100",
    "–í–ê-103 C32",
    "–í–ê-103 C25",
    "–í–ê-103 C16",
    "–í–ê-103 C10",
    "–í–ê-103 C6",
    "–í–ê-103 C50",
    "–í–ê-103 C63",
    "–í–ê-103M D25",
    "–í–ê-103M D16",
    "–í–ê-103M D50",
    "–í–ê-103M D40",
    "–í–ê-103 D16",
    "–í–ê-103 B16",
    "–î–ò–§-103 C16",
    "–î–ò–§-103 C6",
    "–î–ò–§-103 C40",
    "–ê–í–î–¢32 C10",
    "–ê–í–î–¢32 C25",
    "LST-250C-3",
    "LST-160C-3",
    "LST-100C-3",
    "LPN-63C-3",
    "DZ47-60 3P",
    "DZ47-60 1P",
    "YON_MD63-106_B6"
]

# –®–∫–∞—Ñ—ã –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
CABINETS = [
    "–©–†-1 (–í–†–£-1)",
    "–©–†-2 (–í–†–£-1)",
    "–©–†-3 (–í–†–£-2)",
    "–©–†-4 (–í–†–£-2)",
    "–©–†-5 (–í–†–£-3)",
    "–©–†-6 (–í–†–£-3)",
    "–©–†-7 (–í–†–£-4)",
    "–©–†-8 (–í–†–£-4)",
    "–©–ü–î–í-1",
    "–©–ü–î–í-2",
    "–©–ê–í–†",
    "–©–ö–õ",
    "–©–°",
    "–©–û–°",
    "–©–°-1",
    "–©–°-2",
    "–©–°-3",
    "–©–°-4",
    "–©–°-5",
    "–©–°-6",
    "–©–í-1",
    "–©–í-2",
    "–©–í-3",
    "–©–í-4",
    "–©–ü–í",
    "–©–ö–í",
    "–©–û-1",
    "–©–û-2",
    "–©–û-3",
    "–©–ê–û"
]


def generate_report_number(year: int, index: int) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–º–µ—Ä –æ—Ç—á—ë—Ç–∞."""
    month = random.randint(1, 12)
    return f"{month:02d}-{index:02d}/{year}"


def generate_measurement_date(year: int) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–∞—Ç—É –∏–∑–º–µ—Ä–µ–Ω–∏–π."""
    month = random.randint(1, 12)
    day = random.randint(1, 28)
    return f"¬´{day}¬ª {['—è–Ω–≤–∞—Ä—è', '—Ñ–µ–≤—Ä–∞–ª—è', '–º–∞—Ä—Ç–∞', '–∞–ø—Ä–µ–ª—è', '–º–∞—è', '–∏—é–Ω—è',
                      '–∏—é–ª—è', '–∞–≤–≥—É—Å—Ç–∞', '—Å–µ–Ω—Ç—è–±—Ä—è', '–æ–∫—Ç—è–±—Ä—è', '–Ω–æ—è–±—Ä—è', '–¥–µ–∫–∞–±—Ä—è'][month-1]} {year} –≥."


def generate_grounding_measurements(count: int) -> List[Dict]:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –∑–∞–∑–µ–º–ª–µ–Ω–∏—è."""
    measurements = []
    for i in range(1, count + 1):
        cabinet = random.choice(CABINETS)
        measured = round(random.uniform(0.02, 0.05), 2)
        measurements.append({
            "num": i,
            "cabinet": cabinet,
            "elements": 2,
            "allowed": 0.05,
            "measured": measured
        })
    return measurements


def generate_insulation_measurements(count: int) -> List[Dict]:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∏–∑–æ–ª—è—Ü–∏–∏."""
    measurements = []
    for i in range(1, count + 1):
        line = f"–ù{i}.{random.randint(1, 5)}"
        cable = random.choice(CABLE_TYPES)
        measured = random.randint(200, 250)
        measurements.append({
            "num": i,
            "line": line,
            "cable": cable,
            "voltage": 2500,
            "allowed": 0.5,
            "measured": measured
        })
    return measurements


def generate_breaker_measurements(count: int) -> List[Dict]:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π."""
    measurements = []
    for i in range(1, count + 1):
        breaker_type = random.choice(BREAKER_TYPES)
        nominal = random.choice([16, 25, 32, 40, 50, 63, 100])
        overload = nominal
        short_circuit = nominal * 10
        test_overload = random.randint(overload - 5, overload + 5)
        test_short = random.randint(short_circuit - 50, short_circuit + 50)
        time_overload = random.randint(20, 28)
        time_short = 0.10
        
        measurements.append({
            "num": i,
            "equipment": f"QF{i}",
            "type": breaker_type,
            "nominal": nominal,
            "overload": overload,
            "short_circuit": short_circuit,
            "test_overload": test_overload,
            "time_overload": time_overload,
            "test_short": test_short,
            "time_short": time_short
        })
    return measurements


def generate_phase_zero_measurements(count: int) -> List[Dict]:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ü–µ–ø–∏ —Ñ–∞–∑–∞-–Ω—É–ª—å."""
    measurements = []
    for i in range(1, count + 1):
        breaker_type = random.choice(BREAKER_TYPES)
        nominal = random.choice([16, 25, 32, 50, 63, 100])
        emr = nominal * 10
        resistance = round(random.uniform(0.15, 0.70), 2)
        short_circuit = random.randint(200, 2000)
        ratio = round(short_circuit / emr, 2)
        
        measurements.append({
            "num": i,
            "circuit": f"–©–†-{i}",
            "breaker_type": breaker_type,
            "nominal": nominal,
            "emr": emr,
            "resistance": resistance,
            "short_circuit": short_circuit,
            "ratio": ratio,
            "allowed_ratio": 1.1
        })
    return measurements


def generate_report(report_index: int, obj: Dict, year: int = 2024) -> str:
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown."""
    
    report_num = generate_report_number(year, report_index)
    org = random.choice(ANONYMOUS_ORGS)
    customer = random.choice(ANONYMOUS_CUSTOMERS)
    city = random.choice(ANONYMOUS_CITIES)
    street = random.choice(ANONYMOUS_STREETS)
    street_num = random.randint(1, 200)
    address = f"{city}, {street}, {street_num}"
    
    measurement_date = generate_measurement_date(year)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∏–∑–º–µ—Ä–µ–Ω–∏—è
    grounding_count = random.randint(10, 30)
    insulation_count = random.randint(50, 150)
    breaker_count = random.randint(20, 60)
    phase_zero_count = random.randint(30, 80)
    
    grounding_meas = generate_grounding_measurements(grounding_count)
    insulation_meas = generate_insulation_measurements(insulation_count)
    breaker_meas = generate_breaker_measurements(breaker_count)
    phase_zero_meas = generate_phase_zero_measurements(phase_zero_count)
    
    # –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ —É—Å–ª–æ–≤–∏—è
    temp = random.randint(10, 25)
    humidity = random.randint(40, 60)
    pressure = random.randint(730, 750)
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ—Ç—á—ë—Ç
    report = f"""# –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –û–¢–ß–ï–¢ ‚Ññ {report_num}

–ü–û –≠–õ–ï–ö–¢–†–û–ò–ó–ú–ï–†–ò–¢–ï–õ–¨–ù–´–ú –†–ê–ë–û–¢–ê–ú

## –û–ë–™–ï–ö–¢: {obj['name']}

## –ê–î–†–ï–°: {address}

---

**–ß–∞—Å—Ç–∏—á–Ω–∞—è –∏–ª–∏ –ø–æ–ª–Ω–∞—è –ø–µ—Ä–µ–ø–µ—á–∞—Ç–∫–∞ –∏ —Ä–∞–∑–º–Ω–æ–∂–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏—Å–ø—ã—Ç–∞—Ç–µ–ª—å–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏.**
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è.**
**–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã —ç–ª–µ–∫—Ç—Ä–æ—É—Å—Ç–∞–Ω–æ–≤–∫–∏, –ø–æ–¥–≤–µ—Ä–≥–Ω—É—Ç—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º (–ø—Ä–æ–≤–µ—Ä–∫–µ).**

---

## –†–ï–ï–°–¢–† ‚Ññ1 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

{obj['name']}, {city}

| ‚Ññ –ø/–ø | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ | –ö–æ–ª-–≤–æ –ª–∏—Å—Ç–æ–≤ | –°—Ç—Ä. |
|-------|------------------------|---------------|------|
| 1 | –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ {report_num.split('/')[0]}-1/{year} –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Ü–µ–ø–∏ –º–µ–∂–¥—É –∑–∞–∑–µ–º–ª—ë–Ω–Ω—ã–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ | 3 | 3 |
| 2 | –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ {report_num.split('/')[0]}-2/{year} –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∏–∑–æ–ª—è—Ü–∏–∏ | 18 | 6 |
| 3 | –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ {report_num.split('/')[0]}-3/{year} –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º –¥–æ 1000 –í | 24 | 26 |
| 4 | –ü—Ä–æ—Ç–æ–∫–æ–ª ‚Ññ {report_num.split('/')[0]}-4/{year} —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ü–µ–ø–∏ ¬´—Ñ–∞–∑–∞ ‚Äì –Ω—É–ª—å¬ª —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ –∑–∞—â–∏—Ç—ã | 46 | 50 |
| 5 | –ó–∞–∫–ª—é—á–µ–Ω–∏–µ | 1 | 96 |

**–û–±—â–µ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–∞–Ω–∏—Ü:** 96

---

## –ü–†–û–¢–û–ö–û–õ ‚Ññ {report_num.split('/')[0]}-1/{year}

### –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è —Ü–µ–ø–∏ –º–µ–∂–¥—É –∑–∞–∑–µ–º–ª—ë–Ω–Ω—ã–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∑–∞–∑–µ–º–ª—ë–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –≤–æ–∑–¥—É—Ö–∞:** {temp} ¬∞–°  
**–í–ª–∞–∂–Ω–æ—Å—Ç—å –≤–æ–∑–¥—É—Ö–∞:** {humidity} %  
**–ê—Ç–º–æ—Å—Ñ–µ—Ä–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ:** {pressure} –º–º.—Ä—Ç.—Å—Ç.

**–¶–µ–ª—å –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∏—Å–ø—ã—Ç–∞–Ω–∏–π):** –ø—Ä–∏—ë–º–æ-—Å–¥–∞—Ç–æ—á–Ω—ã–µ

**–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:** –ü–£–≠ 1.8.39. –ó–∞–∑–µ–º–ª—è—é—â–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π:

| ‚Ññ –ø/–ø | –ú–µ—Å—Ç–æ—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ | R –¥–æ–ø—É—Å—Ç–∏–º–æ–µ, (–û–º) | R –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–µ, (–û–º) |
|-------|------------------------------------------------------|----------------------------------|-------------------|-------------------|
"""
    
    for m in grounding_meas:
        report += f"| {m['num']} | –®–∫–∞—Ñ {m['cabinet']} | {m['elements']} | {m['allowed']} | {m['measured']} |\n"
    
    report += f"""
**–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–±–æ—Ä–∞–º–∏:**

| ‚Ññ –ø/–ø | –¢–∏–ø | –ó–∞–≤–æ–¥—Å–∫–æ–π –Ω–æ–º–µ—Ä | –î–∏–∞–ø–∞–∑–æ–Ω –∏–∑–º–µ—Ä–µ–Ω–∏—è | –î–∞—Ç–∞ –ø–æ–≤–µ—Ä–∫–∏ | –û—Ä–≥–∞–Ω –º–µ—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã |
|-------|-----|-----------------|-------------------|--------------|------------------------------|
| 1 | –ò–∑–º–µ—Ä–∏—Ç–µ–ª—å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –ò–°-20 | {random.randint(1000, 9999)} | 0,01‚Äì9,99 –û–º | {generate_measurement_date(year)} | –§–ë–£ ¬´–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –¶–°–ú¬ª |

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ù–∞–ª–∏—á–∏–µ —Ü–µ–ø–∏, –µ–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ü–£–≠. –≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≥–æ–¥–Ω–æ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

---

## –ü–†–û–¢–û–ö–û–õ ‚Ññ {report_num.split('/')[0]}-2/{year}

### –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∏–∑–æ–ª—è—Ü–∏–∏

**–¶–µ–ª—å –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∏—Å–ø—ã—Ç–∞–Ω–∏–π):** –ø—Ä–∏—ë–º–æ-—Å–¥–∞—Ç–æ—á–Ω—ã–µ

**–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:** –ü–£–≠ –ø.1.8.40. –°–∏–ª–æ–≤—ã–µ –∫–∞–±–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏.

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π:

| ‚Ññ –ø/–ø | –û–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –ª–∏–Ω–∏–∏ –ø–æ –ø—Ä–æ–µ–∫—Ç—É | –ú–∞—Ä–∫–∞ (—Ç–∏–ø) –∫–∞–±–µ–ª—è, —á–∏—Å–ª–æ –∏ —Å–µ—á–µ–Ω–∏–µ –∂–∏–ª | –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –º–µ–≥–æ–º–º–µ—Ç—Ä–∞, (–í) | –î–æ–ø—É—Å—Ç-–µ —Å–æ–ø—Ä–æ—Ç–∏–≤.–∏–∑–æ–ª—è—Ü–∏–∏, (–ú–û–º) | –ò–∑–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª. –∏–∑–æ–ª—è—Ü–∏–∏, (–ú–û–º) |
|-------|------------------------------|----------------------------------------|---------------------------|----------------------------------|--------------------------------------|
"""
    
    for m in insulation_meas:
        report += f"| {m['num']} | {m['line']} | {m['cable']} | {m['voltage']} | {m['allowed']} | {m['measured']} |\n"
    
    report += f"""
**–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–±–æ—Ä–∞–º–∏:**

| ‚Ññ –ø/–ø | –¢–∏–ø | –ó–∞–≤–æ–¥—Å–∫–æ–π –Ω–æ–º–µ—Ä | –î–∏–∞–ø–∞–∑–æ–Ω –∏–∑–º–µ—Ä–µ–Ω–∏—è | –î–∞—Ç–∞ –ø–æ–≤–µ—Ä–∫–∏ | –û—Ä–≥–∞–Ω –º–µ—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã |
|-------|-----|-----------------|-------------------|--------------|------------------------------|
| 1 | –ú–µ–≥–∞–æ–º–º–µ—Ç—Ä –ï6-24 | {random.randint(10000, 99999)} | 500‚Äì2500 –í | {generate_measurement_date(year)} | –§–ë–£ ¬´–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –¶–°–ú¬ª |

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ –∏–∑–æ–ª—è—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ—Ä–º–∞–º –ù–¢–î.

---

## –ü–†–û–¢–û–ö–û–õ ‚Ññ {report_num.split('/')[0]}-3/{year}

### –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º –¥–æ 1000 –í

**–¶–µ–ª—å –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∏—Å–ø—ã—Ç–∞–Ω–∏–π):** –ø—Ä–∏—ë–º–æ-—Å–¥–∞—Ç–æ—á–Ω—ã–µ

**–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:** –ü–£–≠ –ø.1.8.37 –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ –∞–ø–ø–∞—Ä–∞—Ç—ã, –≤—Ç–æ—Ä–∏—á–Ω—ã–µ —Ü–µ–ø–∏ –∏ —ç–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤–æ–¥–∫–∏ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º –¥–æ 1000–í

1. –ü—Ä–æ–≤–µ–¥—ë–Ω –≤–Ω–µ—à–Ω–∏–π –æ—Å–º–æ—Ç—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π.
2. –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏ –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ.
3. –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è —Ä–∞—Å—Ü–µ–ø–∏—Ç–µ–ª–µ–π –∏–∑ —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π.

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

| ‚Ññ –ø/–ø | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è | –¢–∏–ø–æ–≤–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ, –º–∞—Ä–∫–∏—Ä–æ–≤–∫–∞ | –ù–æ–º–∏–Ω–∞–ª.—Ç–æ–∫, (–ê) | –£—Å—Ç–∞–≤–∫–∞ —Ä–∞—Å—Ü–µ–ø–∏—Ç–µ–ª–µ–π | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Ü–µ–ø–∏—Ç–µ–ª—è |
|-------|---------------------------|--------------------------------|------------------|---------------------|---------------------|
| | | | | —Ç–æ–∫–æ–≤ –ø–µ—Ä–µ–≥—Ä—É–∑-–∫–∏, (–ê) | —Ç–æ–∫–æ–≤ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∑–∞–º—ã–∫-—è, (–ê) | –¢–æ–∫–∞ –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ | –¢–æ–∫–∞ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ –∑–∞–º—ã–∫–∞–Ω–∏—è |
| | | | | | | –ò—Å–ø—ã—Ç–∞-—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫, (–ê) | –í—Ä–µ–º—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, (—Å–µ–∫) | –¢–æ–∫ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Ä–∞—Å—Ü–µ–ø–∏—Ç–µ–ª—è, (–ê) | –í—Ä–µ–º—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è, (—Å–µ–∫) |
| | | | | | | –¥–æ–ø—É—Å—Ç–∏-–º–æ–µ | –∏–∑–º–µ—Ä–µ–Ω-–Ω–æ–µ | | |
"""
    
    for m in breaker_meas:
        report += f"| {m['num']} | {m['equipment']} | {m['type']} | {m['nominal']} | {m['overload']} | {m['short_circuit']} | 10-45 | {m['time_overload']} | {m['test_short']} | {m['time_short']} |\n"
    
    report += f"""
**–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–±–æ—Ä–∞–º–∏:**

| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –¢–∏–ø | –ó–∞–≤–æ–¥—Å–∫–æ–π ‚Ññ | –î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–≤–µ—Ä–∫–∏ | –û—Ä–≥–∞–Ω –º–µ—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–ª—É–∂–±—ã |
|--------------|-----|-------------|----------------------|----------------------------|
| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ä–µ–¥—Å—Ç–≤ —Ä–µ–ª–µ–π–Ω–æ–π –∑–∞—â–∏—Ç—ã | –°–∞—Ç—É—Ä–Ω –ú1 | {random.randint(1000, 9999)} | {generate_measurement_date(year)} | –§–ë–£ ¬´–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –¶–°–ú¬ª |

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á—ë—Ç–Ω–æ–≥–æ —Ç–æ–∫–∞ –ö.–ó. –∏ —Ç–æ–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ù–¢–î. –≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–≥–æ–¥–Ω–æ –∫ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

---

## –ü–†–û–¢–û–ö–û–õ ‚Ññ {report_num.split('/')[0]}-4/{year}

### —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ü–µ–ø–∏ ¬´—Ñ–∞–∑–∞ ‚Äì –Ω—É–ª—å¬ª —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ –∑–∞—â–∏—Ç—ã

**–¶–µ–ª—å –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∏—Å–ø—ã—Ç–∞–Ω–∏–π):** –ø—Ä–∏—ë–º–æ-—Å–¥–∞—Ç–æ—á–Ω—ã–µ

**–ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:** –ü–¢–≠–≠–ü –ü—Ä–∏–ª. 3 –ø.28.4.

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:

| ‚Ññ –ø/–ø | –ü—Ä–æ–≤–µ—Ä—è–µ–º—ã–π —É—á–∞—Å—Ç–æ–∫ —Ü–µ–ø–∏ | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞—â–∏—Ç—ã | –ò–∑–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª. –û–º | –†–∞—Å—á—ë—Ç–Ω—ã–π —Ç–æ–∫ –∫.–∑., –ê | –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á—ë—Ç–Ω–æ–≥–æ —Ç–æ–∫–∞ –∏ —Ç–æ–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è | –î–æ–ø—É—Å—Ç–∏–º–∞—è –∫—Ä–∞—Ç–Ω–æ—Å—Ç—å |
|-------|--------------------------|-------------------|-------------------------|---------------------|----------------------------------------------|---------------------|
| | | –¢–∏–ø | –ù–æ–º–∏–Ω. —Ç–æ–∫, –ê | –¢–æ–∫ —ç–ª.–º–∞–≥–Ω–∏—Ç–Ω–æ–≥–æ –†–∞—Å—Ü–µ–ø., (–ê) | | | |
"""
    
    for m in phase_zero_meas:
        report += f"| {m['num']} | {m['circuit']} | {m['breaker_type']} | {m['nominal']} | {m['emr']} | {m['resistance']} | {m['short_circuit']} | {m['ratio']} | {m['allowed_ratio']} |\n"
    
    report += f"""
**–ò–∑–º–µ—Ä–µ–Ω–∏—è –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –ø—Ä–∏–±–æ—Ä–∞–º–∏:**

| –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –¢–∏–ø | –ó–∞–≤–æ–¥—Å–∫–æ–π ‚Ññ | –î–∞—Ç–∞ –ø–æ–≤–µ—Ä–∫–∏ |
|--------------|-----|-------------|--------------|
| –ò–∑–º–µ—Ä–∏—Ç–µ–ª—å —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –ø–µ—Ç–ª–∏ —Ñ–∞–∑–∞-–Ω—É–ª—å | –ò–§–ù-200 | {random.randint(1000, 9999)} | {generate_measurement_date(year)} |

**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ:** –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á—ë—Ç–Ω–æ–≥–æ —Ç–æ–∫–∞ –ö.–ó. –∏ —Ç–æ–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ù–¢–î.

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç –Ω–∞ {obj['name']}, {address}, –±—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã –∏—Å–ø—ã—Ç–∞–Ω–∏—è –∫–∞–±–µ–ª—å–Ω—ã—Ö –ª–∏–Ω–∏–π –∏ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –ü–£–≠, –†–î –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º –∑–∞–≤–æ–¥–æ–≤-–∏–∑–≥–æ—Ç–æ–≤–∏—Ç–µ–ª–µ–π. –°–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º —ç–ª–µ–∫—Ç—Ä–æ–∏–∑–º–µ—Ä–µ–Ω–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞ {report_num}, –∫–∞–±–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏ –∏ —ç–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –Ω–∏–∂–µ–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:

1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ü–µ–ø–∏ –º–µ–∂–¥—É –∑–∞–∑–µ–º–ª–µ–Ω–Ω—ã–º–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞–º–∏ –∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∑–∞–∑–µ–º–ª–µ–Ω–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏: –†–î 34.45-51.300-97, –ø.28.2;
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∏–∑–æ–ª—è—Ü–∏–∏: –ü–£–≠ 1.8.40;
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ–º –¥–æ 1000–í: –ü–£–≠ –ø.1.8.37;
4. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ü–µ–ø–∏ ¬´—Ñ–∞–∑–∞-–Ω—É–ª—å¬ª —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ –∑–∞—â–∏—Ç—ã: –ü–£–≠ –ø.1.7.79.

---

**–ó–∞–∫–∞–∑—á–∏–∫:** {customer}  
**–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å:** {org}  
**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏–π:** {measurement_date}

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –î–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∏ —Å–æ–∑–¥–∞–Ω –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π. –í—Å–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –Ω–∞–∑–≤–∞–Ω–∏—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∏ –∞–¥—Ä–µ—Å–∞ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ –∞–Ω–æ–Ω–∏–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
"""
    
    return report


def generate_all_reports():
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –≤—Å–µ 15 –æ—Ç—á—ë—Ç–æ–≤."""
    logger.info("üöÄ –ù–∞—á–∞–ª–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ 15 –∞–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤...")
    
    year = 2024
    
    for i, obj in enumerate(REPORT_OBJECTS, 1):
        logger.info(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ {i}/15: {obj['name']}")
        
        report_content = generate_report(i, obj, year)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º –∏–º—è —Ñ–∞–π–ª–∞
        type_prefix = {
            "stadium": "stadium",
            "mall": "mall",
            "school": "school",
            "factory": "factory",
            "residential": "residential"
        }[obj['type']]
        
        filename = f"report_{i:02d}_{type_prefix}_{obj['name'].lower().replace(' ', '_').replace('¬´', '').replace('¬ª', '').replace(',', '').replace('.', '')[:30]}.md"
        filepath = REPORTS_DIR / filename
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ç—á—ë—Ç
        with open(filepath, 'w', encoding='utf-8') as f:
            f.write(report_content)
        
        logger.info(f"‚úÖ –°–æ—Ö—Ä–∞–Ω—ë–Ω: {filename}")
    
    logger.info(f"\nüéâ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –í—Å–µ –æ—Ç—á—ë—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {REPORTS_DIR}")
    logger.info(f"üìä –í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ: {len(REPORT_OBJECTS)} –æ—Ç—á—ë—Ç–æ–≤")


if __name__ == "__main__":
    generate_all_reports()

